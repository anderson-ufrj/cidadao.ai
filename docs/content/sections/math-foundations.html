<!-- Fundamentos Matemáticos PhD-Level para Sistema Multi-Agente -->

<style>
    .theorem-box {
        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
        border: 2px solid #0284c7;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
    .theorem-title {
        color: #0c4a6e;
        font-weight: 600;
        margin-bottom: 1.5rem;
        font-size: 1.1rem;
    }
    .proof-box {
        background: #f0fdf4;
        border-radius: 0.5rem;
        padding: 1rem;
        font-style: italic;
        margin-top: 1rem;
    }
    .definition-box {
        background: white;
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin: 1.5rem 0;
        font-family: 'Courier New', monospace;
        font-size: 0.95rem;
    }
    .math-formula {
        text-align: center;
        margin: 1.5rem 0;
        font-size: 1.1rem;
        font-family: 'Times New Roman', serif;
    }
    .optimization-box {
        background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        border: 2px solid #16a34a;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
    .complexity-box {
        background: linear-gradient(135deg, #fef3c7, #fde68a);
        border: 2px solid #f59e0b;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
</style>

<!-- Título Principal -->
<h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin: 3rem 0 1.5rem 0;">
    📐 Fundamentos Matemáticos e Formalismos Teóricos
</h3>

<!-- Definição Formal do Sistema -->
<div class="theorem-box">
    <h4 class="theorem-title">Definição 1: Sistema Multi-Agente Heterogêneo para Transparência Pública</h4>
    <div class="definition-box">
        <p><strong>Definição Formal:</strong> Seja Ξ = ⟨A, E, S, O, T, Π, Φ, Ψ⟩ um sistema multi-agente onde:</p>
        <ul style="list-style: none; margin: 1rem 0; line-height: 1.8;">
            <li>• <strong>A = {a₁, a₂, ..., a₁₇}</strong> é o conjunto finito de agentes heterogêneos</li>
            <li>• <strong>E ⊆ A × A</strong> é o conjunto de canais de comunicação (grafo direcionado)</li>
            <li>• <strong>S = S₁ × S₂ × ... × S₁₇</strong> é o espaço de estados global do sistema</li>
            <li>• <strong>O = ⋃ᵢ₌₁¹⁷ Oᵢ</strong> é o espaço de observações parciais</li>
            <li>• <strong>T: S × A × Π → Δ(S)</strong> é a função de transição estocástica</li>
            <li>• <strong>Π = ⋃ᵢ₌₁¹⁷ Πᵢ</strong> é o espaço de ações conjuntas</li>
            <li>• <strong>Φ: S → ℝⁿ</strong> é a função de features do estado</li>
            <li>• <strong>Ψ: O × H → Π</strong> é a política de decisão com memória H</li>
        </ul>
        
        <p style="margin-top: 1.5rem;"><strong>Propriedades Fundamentais:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.6;">
            <p><strong>1. Observabilidade Parcial:</strong> ∀aᵢ ∈ A, ∃ηᵢ: S → Oᵢ tal que aᵢ observa apenas ηᵢ(s)</p>
            <p><strong>2. Comunicação Assíncrona:</strong> Mensagens m ∈ M são transmitidas com delay δ ~ Exp(λ)</p>
            <p><strong>3. Heterogeneidade:</strong> ∀i ≠ j, Πᵢ ∩ Πⱼ = ∅ (ações especializadas e disjuntas)</p>
        </div>
    </div>
</div>

<!-- Teorema de Convergência -->
<div class="theorem-box">
    <h4 class="theorem-title">Teorema 1: Convergência Assintótica com Comunicação Limitada</h4>
    <div class="definition-box">
        <p><strong>Enunciado:</strong> Considere o protocolo de consenso distribuído no sistema Cidadão.AI:</p>
        <div class="math-formula">
            x<sub>i</sub>(t+1) = w<sub>ii</sub>x<sub>i</sub>(t) + Σ<sub>j∈N<sub>i</sub>(t)</sub> w<sub>ij</sub>(t)x<sub>j</sub>(t) + ε<sub>i</sub>(t)
        </div>
        <p>onde N<sub>i</sub>(t) é a vizinhança ativa no tempo t, w<sub>ij</sub>(t) são pesos adaptativos e ε<sub>i</sub>(t) ~ 𝒩(0, σ²<sub>i</sub>).</p>
        
        <p style="margin-top: 1.5rem;"><strong>Condições Necessárias e Suficientes:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.8;">
            <p><strong>C1. Conectividade Temporal:</strong> O grafo união G<sub>∞</sub> = ⋃<sub>k=0</sub><sup>∞</sup> G(kT, (k+1)T) é fortemente conectado</p>
            <p><strong>C2. Balanço Estocástico:</strong> E[W(t)] é duplamente estocástica quase certamente</p>
            <p><strong>C3. Limitação de Ruído:</strong> ‖ε<sub>i</sub>(t)‖ ≤ ε̄ < ∞ ∀i,t com probabilidade 1</p>
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Conclusão:</strong> Sob as condições C1-C3, ∃ x* ∈ ℝᵈ tal que:</p>
        <div class="math-formula">
            lim<sub>t→∞</sub> E[‖x<sub>i</sub>(t) - x*‖²] ≤ κσ²/μ
        </div>
        <p>onde κ é o número de condição do grafo de comunicação e μ > 0 é o gap espectral.</p>
    </div>
    <div class="proof-box">
        <p><strong>Esboço da Prova:</strong> Utilizando a função de Lyapunov V(t) = Σᵢ‖xᵢ(t) - x̄(t)‖² e aplicando o lema de convergência de Robbins-Monro com condições de Novikov, demonstra-se que o sistema converge quase certamente para o consenso com taxa exponencial sob ruído limitado.</p>
    </div>
</div>

<!-- Teorema de Otimalidade -->
<div class="optimization-box">
    <h4 style="color: #14532d; margin-bottom: 1.5rem; font-weight: 600;">Teorema 2: Otimalidade de Alocação Multi-Agente sob Incerteza</h4>
    <div class="definition-box">
        <p><strong>Problema de Otimização Estocástica:</strong></p>
        <div style="margin: 1.5rem 0; line-height: 1.8;">
            <div class="math-formula">min<sub>x∈X</sub> 𝔼[f(x,ξ)] = ∫<sub>Ξ</sub> f(x,ξ)P(dξ)</div>
            <p style="margin-top: 0.5rem;">sujeito a:</p>
            <div style="margin-left: 2rem;">
                <p>g<sub>i</sub>(x) ≤ 0, i = 1,...,m (restrições de capacidade)</p>
                <p>h<sub>j</sub>(x) = 0, j = 1,...,p (restrições de balanceamento)</p>
                <p>x ∈ X ⊆ ℝⁿ (conjunto viável convexo e compacto)</p>
            </div>
        </div>
        
        <p><strong>Formulação Lagrangiana Aumentada:</strong></p>
        <div class="math-formula">
            L<sub>ρ</sub>(x,λ,μ) = 𝔼[f(x,ξ)] + Σᵢλᵢgᵢ(x) + Σⱼμⱼhⱼ(x) + (ρ/2)‖c(x)‖²
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Algoritmo ADMM Distribuído para Sistema Multi-Agente:</strong></p>
        <div style="margin: 1rem 0; background: #f8fafc; padding: 1rem; border-radius: 0.5rem;">
            <p><strong>Passo 1:</strong> x<sup>(k+1)</sup> = argmin<sub>x</sub> L<sub>ρ</sub>(x, λ<sup>k</sup>, μ<sup>k</sup>)</p>
            <p><strong>Passo 2:</strong> λᵢ<sup>(k+1)</sup> = max(0, λᵢ<sup>k</sup> + ρgᵢ(x<sup>(k+1)</sup>))</p>
            <p><strong>Passo 3:</strong> μⱼ<sup>(k+1)</sup> = μⱼ<sup>k</sup> + ρhⱼ(x<sup>(k+1)</sup>)</p>
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Taxa de Convergência Garantida:</strong></p>
        <ul style="margin-left: 1.5rem; line-height: 1.6;">
            <li>• <strong>Caso Convexo:</strong> O(1/√k) para problema geral</li>
            <li>• <strong>Caso Fortemente Convexo:</strong> O(ρᵏ) com 0 < ρ < 1</li>
            <li>• <strong>Caso Smooth:</strong> O(1/k) com gradiente Lipschitz</li>
        </ul>
    </div>
</div>

<!-- Complexidade Computacional -->
<div class="complexity-box">
    <h4 style="color: #78350f; margin-bottom: 1.5rem; font-weight: 600;">Teorema 3: Complexidade Computacional do Sistema</h4>
    <div class="definition-box">
        <p><strong>Complexidade Temporal por Iteração:</strong></p>
        <div class="math-formula">
            T(n,m,d) = O(n²d + nm + d³)
        </div>
        <p>onde n = |A| (número de agentes), m = número de restrições, d = dimensionalidade do espaço de estados.</p>
        
        <p style="margin-top: 1.5rem;"><strong>Complexidade de Memória:</strong></p>
        <div class="math-formula">
            M(n,d,h) = O(nd² + nh + d²)
        </div>
        <p>onde h é o horizonte de memória para políticas com histórico.</p>
        
        <p style="margin-top: 1.5rem;"><strong>Complexidade de Comunicação:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.6;">
            <p><strong>• Bits por round:</strong> O(nd log(1/ε)) para precisão ε</p>
            <p><strong>• Rounds para convergência:</strong> O(log(1/δ)/μ) com probabilidade 1-δ</p>
            <p><strong>• Bandwidth total:</strong> O(n²d log(1/ε) log(1/δ)/μ)</p>
        </div>
    </div>
</div>

<!-- Métricas de Performance -->
<h4 style="color: var(--text-primary); margin: 2rem 0 1rem 0; font-weight: 600;">📊 Métricas de Performance Teóricas</h4>

<div style="display: grid; gap: 1.5rem; margin: 2rem 0;">
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Latência de Consenso</h5>
        <p>Tempo esperado para convergência: <strong>E[T<sub>consensus</sub>] ≤ (log n)/μ + O(σ²/μ²)</strong></p>
    </div>
    
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Precisão de Detecção</h5>
        <p>Probabilidade de detecção correta: <strong>P(detecção) ≥ 1 - exp(-nμt/2)</strong></p>
    </div>
    
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Escalabilidade</h5>
        <p>Suporta até <strong>n = O(10³)</strong> agentes com degradação graceful de O(log n)</p>
    </div>
</div>

<!-- Aplicação no Contexto de Transparência -->
<div style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border: 2px solid #ef4444; border-radius: 1rem; padding: 2rem; margin: 2rem 0;">
    <h4 style="color: #991b1b; margin-bottom: 1.5rem;">Aplicação: Detecção Distribuída de Anomalias</h4>
    <div class="definition-box">
        <p><strong>Modelagem do Problema:</strong></p>
        <ul style="margin: 1rem 0; line-height: 1.8;">
            <li>• <strong>Estado x<sub>i</sub>:</strong> Vetor de features extraídas de contratos/licitações</li>
            <li>• <strong>Observação y<sub>i</sub>:</strong> Score de anomalia computado localmente</li>
            <li>• <strong>Consenso z*:</strong> Decisão global sobre existência de irregularidade</li>
            <li>• <strong>Restrições:</strong> Privacidade, latência < 1s, precisão > 95%</li>
        </ul>
        
        <p><strong>Garantias do Sistema:</strong></p>
        <div class="math-formula">
            P(|z<sub>i</sub>(T) - z*| < ε) ≥ 1 - δ, ∀i ∈ A
        </div>
        <p>onde T = O(log(1/δ)/μ) é o tempo de convergência e ε > 0 é a tolerância desejada.</p>
    </div>
</div>