<!-- PhD-Level Mathematical Foundations for Multi-Agent System -->

<style>
    .theorem-box {
        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
        border: 2px solid #0284c7;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
    .theorem-title {
        color: #0c4a6e;
        font-weight: 600;
        margin-bottom: 1.5rem;
        font-size: 1.1rem;
    }
    .proof-box {
        background: #f0fdf4;
        border-radius: 0.5rem;
        padding: 1rem;
        font-style: italic;
        margin-top: 1rem;
    }
    .definition-box {
        background: white;
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin: 1.5rem 0;
        font-family: 'Courier New', monospace;
        font-size: 0.95rem;
    }
    .math-formula {
        text-align: center;
        margin: 1.5rem 0;
        font-size: 1.1rem;
        font-family: 'Times New Roman', serif;
    }
    .optimization-box {
        background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        border: 2px solid #16a34a;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
    .complexity-box {
        background: linear-gradient(135deg, #fef3c7, #fde68a);
        border: 2px solid #f59e0b;
        border-radius: 1rem;
        padding: 2rem;
        margin: 2rem 0;
    }
</style>

<!-- Main Title -->
<h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin: 3rem 0 1.5rem 0;">
    ğŸ“ Mathematical Foundations and Theoretical Formalisms
</h3>

<!-- Formal System Definition -->
<div class="theorem-box">
    <h4 class="theorem-title">Definition 1: Heterogeneous Multi-Agent System for Public Transparency</h4>
    <div class="definition-box">
        <p><strong>Formal Definition:</strong> Let Î = âŸ¨A, E, S, O, T, Î , Î¦, Î¨âŸ© be a multi-agent system where:</p>
        <ul style="list-style: none; margin: 1rem 0; line-height: 1.8;">
            <li>â€¢ <strong>A = {aâ‚, aâ‚‚, ..., aâ‚â‚‡}</strong> is the finite set of heterogeneous agents</li>
            <li>â€¢ <strong>E âŠ† A Ã— A</strong> is the set of communication channels (directed graph)</li>
            <li>â€¢ <strong>S = Sâ‚ Ã— Sâ‚‚ Ã— ... Ã— Sâ‚â‚‡</strong> is the global state space of the system</li>
            <li>â€¢ <strong>O = â‹ƒáµ¢â‚Œâ‚Â¹â· Oáµ¢</strong> is the partial observation space</li>
            <li>â€¢ <strong>T: S Ã— A Ã— Î  â†’ Î”(S)</strong> is the stochastic transition function</li>
            <li>â€¢ <strong>Î  = â‹ƒáµ¢â‚Œâ‚Â¹â· Î áµ¢</strong> is the joint action space</li>
            <li>â€¢ <strong>Î¦: S â†’ â„â¿</strong> is the state feature function</li>
            <li>â€¢ <strong>Î¨: O Ã— H â†’ Î </strong> is the decision policy with memory H</li>
        </ul>
        
        <p style="margin-top: 1.5rem;"><strong>Fundamental Properties:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.6;">
            <p><strong>1. Partial Observability:</strong> âˆ€aáµ¢ âˆˆ A, âˆƒÎ·áµ¢: S â†’ Oáµ¢ such that aáµ¢ observes only Î·áµ¢(s)</p>
            <p><strong>2. Asynchronous Communication:</strong> Messages m âˆˆ M are transmitted with delay Î´ ~ Exp(Î»)</p>
            <p><strong>3. Heterogeneity:</strong> âˆ€i â‰  j, Î áµ¢ âˆ© Î â±¼ = âˆ… (specialized and disjoint actions)</p>
        </div>
    </div>
</div>

<!-- Convergence Theorem -->
<div class="theorem-box">
    <h4 class="theorem-title">Theorem 1: Asymptotic Convergence with Limited Communication</h4>
    <div class="definition-box">
        <p><strong>Statement:</strong> Consider the distributed consensus protocol in the CidadÃ£o.AI system:</p>
        <div class="math-formula">
            x<sub>i</sub>(t+1) = w<sub>ii</sub>x<sub>i</sub>(t) + Î£<sub>jâˆˆN<sub>i</sub>(t)</sub> w<sub>ij</sub>(t)x<sub>j</sub>(t) + Îµ<sub>i</sub>(t)
        </div>
        <p>where N<sub>i</sub>(t) is the active neighborhood at time t, w<sub>ij</sub>(t) are adaptive weights and Îµ<sub>i</sub>(t) ~ ğ’©(0, ÏƒÂ²<sub>i</sub>).</p>
        
        <p style="margin-top: 1.5rem;"><strong>Necessary and Sufficient Conditions:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.8;">
            <p><strong>C1. Temporal Connectivity:</strong> The union graph G<sub>âˆ</sub> = â‹ƒ<sub>k=0</sub><sup>âˆ</sup> G(kT, (k+1)T) is strongly connected</p>
            <p><strong>C2. Stochastic Balance:</strong> E[W(t)] is doubly stochastic almost surely</p>
            <p><strong>C3. Noise Limitation:</strong> â€–Îµ<sub>i</sub>(t)â€– â‰¤ ÎµÌ„ < âˆ âˆ€i,t with probability 1</p>
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Conclusion:</strong> Under conditions C1-C3, âˆƒ x* âˆˆ â„áµˆ such that:</p>
        <div class="math-formula">
            lim<sub>tâ†’âˆ</sub> E[â€–x<sub>i</sub>(t) - x*â€–Â²] â‰¤ ÎºÏƒÂ²/Î¼
        </div>
        <p>where Îº is the condition number of the communication graph and Î¼ > 0 is the spectral gap.</p>
    </div>
    <div class="proof-box">
        <p><strong>Proof Sketch:</strong> Using the Lyapunov function V(t) = Î£áµ¢â€–xáµ¢(t) - xÌ„(t)â€–Â² and applying the Robbins-Monro convergence lemma with Novikov conditions, we demonstrate that the system converges almost surely to consensus with exponential rate under bounded noise.</p>
    </div>
</div>

<!-- Optimality Theorem -->
<div class="optimization-box">
    <h4 style="color: #14532d; margin-bottom: 1.5rem; font-weight: 600;">Theorem 2: Multi-Agent Allocation Optimality under Uncertainty</h4>
    <div class="definition-box">
        <p><strong>Stochastic Optimization Problem:</strong></p>
        <div style="margin: 1.5rem 0; line-height: 1.8;">
            <div class="math-formula">min<sub>xâˆˆX</sub> ğ”¼[f(x,Î¾)] = âˆ«<sub>Î</sub> f(x,Î¾)P(dÎ¾)</div>
            <p style="margin-top: 0.5rem;">subject to:</p>
            <div style="margin-left: 2rem;">
                <p>g<sub>i</sub>(x) â‰¤ 0, i = 1,...,m (capacity constraints)</p>
                <p>h<sub>j</sub>(x) = 0, j = 1,...,p (balance constraints)</p>
                <p>x âˆˆ X âŠ† â„â¿ (convex and compact feasible set)</p>
            </div>
        </div>
        
        <p><strong>Augmented Lagrangian Formulation:</strong></p>
        <div class="math-formula">
            L<sub>Ï</sub>(x,Î»,Î¼) = ğ”¼[f(x,Î¾)] + Î£áµ¢Î»áµ¢gáµ¢(x) + Î£â±¼Î¼â±¼hâ±¼(x) + (Ï/2)â€–c(x)â€–Â²
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Distributed ADMM Algorithm for Multi-Agent System:</strong></p>
        <div style="margin: 1rem 0; background: #f8fafc; padding: 1rem; border-radius: 0.5rem;">
            <p><strong>Step 1:</strong> x<sup>(k+1)</sup> = argmin<sub>x</sub> L<sub>Ï</sub>(x, Î»<sup>k</sup>, Î¼<sup>k</sup>)</p>
            <p><strong>Step 2:</strong> Î»áµ¢<sup>(k+1)</sup> = max(0, Î»áµ¢<sup>k</sup> + Ïgáµ¢(x<sup>(k+1)</sup>))</p>
            <p><strong>Step 3:</strong> Î¼â±¼<sup>(k+1)</sup> = Î¼â±¼<sup>k</sup> + Ïhâ±¼(x<sup>(k+1)</sup>)</p>
        </div>
        
        <p style="margin-top: 1.5rem;"><strong>Guaranteed Convergence Rate:</strong></p>
        <ul style="margin-left: 1.5rem; line-height: 1.6;">
            <li>â€¢ <strong>Convex Case:</strong> O(1/âˆšk) for general problem</li>
            <li>â€¢ <strong>Strongly Convex Case:</strong> O(Ïáµ) with 0 < Ï < 1</li>
            <li>â€¢ <strong>Smooth Case:</strong> O(1/k) with Lipschitz gradient</li>
        </ul>
    </div>
</div>

<!-- Computational Complexity -->
<div class="complexity-box">
    <h4 style="color: #78350f; margin-bottom: 1.5rem; font-weight: 600;">Theorem 3: Computational Complexity of the System</h4>
    <div class="definition-box">
        <p><strong>Time Complexity per Iteration:</strong></p>
        <div class="math-formula">
            T(n,m,d) = O(nÂ²d + nm + dÂ³)
        </div>
        <p>where n = |A| (number of agents), m = number of constraints, d = state space dimensionality.</p>
        
        <p style="margin-top: 1.5rem;"><strong>Memory Complexity:</strong></p>
        <div class="math-formula">
            M(n,d,h) = O(ndÂ² + nh + dÂ²)
        </div>
        <p>where h is the memory horizon for history-based policies.</p>
        
        <p style="margin-top: 1.5rem;"><strong>Communication Complexity:</strong></p>
        <div style="margin: 1rem 0; line-height: 1.6;">
            <p><strong>â€¢ Bits per round:</strong> O(nd log(1/Îµ)) for precision Îµ</p>
            <p><strong>â€¢ Rounds to convergence:</strong> O(log(1/Î´)/Î¼) with probability 1-Î´</p>
            <p><strong>â€¢ Total bandwidth:</strong> O(nÂ²d log(1/Îµ) log(1/Î´)/Î¼)</p>
        </div>
    </div>
</div>

<!-- Performance Metrics -->
<h4 style="color: var(--text-primary); margin: 2rem 0 1rem 0; font-weight: 600;">ğŸ“Š Theoretical Performance Metrics</h4>

<div style="display: grid; gap: 1.5rem; margin: 2rem 0;">
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Consensus Latency</h5>
        <p>Expected convergence time: <strong>E[T<sub>consensus</sub>] â‰¤ (log n)/Î¼ + O(ÏƒÂ²/Î¼Â²)</strong></p>
    </div>
    
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Detection Accuracy</h5>
        <p>Correct detection probability: <strong>P(detection) â‰¥ 1 - exp(-nÎ¼t/2)</strong></p>
    </div>
    
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-light); border-radius: 0.5rem; padding: 1.5rem;">
        <h5 style="color: var(--text-accent); margin-bottom: 0.5rem;">Scalability</h5>
        <p>Supports up to <strong>n = O(10Â³)</strong> agents with graceful O(log n) degradation</p>
    </div>
</div>

<!-- Application in Transparency Context -->
<div style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border: 2px solid #ef4444; border-radius: 1rem; padding: 2rem; margin: 2rem 0;">
    <h4 style="color: #991b1b; margin-bottom: 1.5rem;">Application: Distributed Anomaly Detection</h4>
    <div class="definition-box">
        <p><strong>Problem Modeling:</strong></p>
        <ul style="margin: 1rem 0; line-height: 1.8;">
            <li>â€¢ <strong>State x<sub>i</sub>:</strong> Feature vector extracted from contracts/biddings</li>
            <li>â€¢ <strong>Observation y<sub>i</sub>:</strong> Locally computed anomaly score</li>
            <li>â€¢ <strong>Consensus z*:</strong> Global decision on irregularity existence</li>
            <li>â€¢ <strong>Constraints:</strong> Privacy, latency < 1s, accuracy > 95%</li>
        </ul>
        
        <p><strong>System Guarantees:</strong></p>
        <div class="math-formula">
            P(|z<sub>i</sub>(T) - z*| < Îµ) â‰¥ 1 - Î´, âˆ€i âˆˆ A
        </div>
        <p>where T = O(log(1/Î´)/Î¼) is the convergence time and Îµ > 0 is the desired tolerance.</p>
    </div>
</div>