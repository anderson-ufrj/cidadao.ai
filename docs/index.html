<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="site.title">Cidadão.AI — Documentação Técnica Backend</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Documentação técnica completa do backend Cidadão.AI - Sistema multi-agente de IA para transparência pública">
    <meta name="keywords" content="Cidadão.AI, transparência pública, IA ética, open government, ODS 16, backend, FastAPI">
    <meta name="author" content="Anderson Henrique">
    
    <!-- Fonts - Optimized for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="assets/css/main.css">
    <!-- OfflineAccordion - Sistema Completo (funciona sem servidor) -->
    <link rel="stylesheet" href="assets/css/super-accordion.css">
    <!-- GitHub Pages Config -->
    <script src=".github-pages-config.js"></script>
    <script src="src/utils/OfflineAccordion.js" defer></script>
</head>
<body>
    <!-- Navegação Principal -->
    <nav class="navbar" role="navigation" aria-label="Navegação principal">
        <div class="navbar-container">
            <!-- Logo -->
            <a href="#" class="logo" aria-label="Cidadão.AI - Página inicial">
                <div class="logo-icon">🏛️</div>
                <span class="logo-text">Cidadão.AI</span>
            </a>
            
            <!-- Controles -->
            <div class="nav-controls">
                <!-- Progresso de Leitura (só no modo leitura) -->
                <div class="reading-progress-indicator" id="readingProgressIndicator" style="display: none;">
                    <span class="reading-progress-text" id="readingProgressText">0% lido</span>
                </div>
                
                <!-- Toggle Sidebar (só no modo leitura mobile) -->
                <button class="control-button reading-sidebar-toggle" id="readingSidebarToggle" style="display: none;" data-i18n="reading.toggle-sidebar" aria-label="Mostrar/esconder índice">
                    ☰
                </button>
                
                <!-- Tema -->
                <div class="control-group" role="group" aria-label="Seletor de tema">
                    <button class="control-button" data-theme-btn="light" data-i18n="nav.theme.light" aria-label="Tema claro">
                        ☀️ Claro
                    </button>
                    <button class="control-button" data-theme-btn="dark" data-i18n="nav.theme.dark" aria-label="Tema escuro">
                        🌙 Escuro
                    </button>
                </div>
                
                <!-- Idioma -->
                <div class="control-group" role="group" aria-label="Seletor de idioma">
                    <button class="control-button" data-lang-btn="pt-BR" data-reading-lang-btn="pt-BR" data-i18n="nav.lang.pt" aria-label="Português">
                        🇧🇷 PT
                    </button>
                    <button class="control-button" data-lang-btn="en-US" data-reading-lang-btn="en-US" data-i18n="nav.lang.en" aria-label="English">
                        🇺🇸 EN
                    </button>
                </div>
                
                <!-- Botão Voltar (só no modo leitura) -->
                <button class="control-button reading-back-to-main-header" id="readingBackToMainHeader" style="display: none;" data-i18n="reading.back-to-main" aria-label="Voltar à página principal">
                    ← Voltar
                </button>
                
                <!-- Botão Fechar Modo Leitura (só no modo leitura) -->
                <button class="control-button reading-close-button" id="readingCloseButton" data-modal-close="readingModal" style="display: none;" data-i18n="reading.close" aria-label="Fechar modo leitura">
                    ✕ Fechar
                </button>
            </div>
        </div>
    </nav>

    <!-- Conteúdo Principal -->
    <main role="main">
        <!-- Hero Section -->
        <section class="hero" aria-labelledby="hero-title">
            <div class="hero-container">
                <div class="hero-badge" data-i18n="hero.badge">
                    🇧🇷 Documentação Técnica Backend
                </div>
                
                <h1 id="hero-title" class="hero-title" data-i18n="hero.title">
                    Cidadão.AI Backend
                </h1>
                
            </div>
        </section>

        <!-- Documentação Técnica Accordion -->
        <section id="technical-sections" class="section" aria-labelledby="sections-title">
            <div class="section-container">
                <h2 id="sections-title" class="section-title" data-i18n="section.technical.title">
                    Documentação Técnica
                </h2>

                <!-- Controles Globais -->
                <div class="accordion-controls">
                    <div class="controls-left">
                        <button class="control-btn expand-all" data-i18n="controls.expand-all">
                            📖 Expandir Todas
                        </button>
                        <button class="control-btn collapse-all" data-i18n="controls.collapse-all">
                            📕 Recolher Todas
                        </button>
                        <button class="control-btn reading-mode" id="readingModeBtn" data-i18n="controls.reading-mode">
                            📚 Modo Leitura
                        </button>
                        <button class="control-btn print-btn" id="printBtn" data-i18n="controls.print">
                            🖨️ Imprimir
                        </button>
                    </div>
                    <div class="controls-right">
                        <div class="search-box">
                            <input type="text" id="searchInput" placeholder="🔍 Buscar na documentação..." data-i18n-placeholder="search.placeholder">
                            <button class="search-clear" id="searchClear">✕</button>
                        </div>
                    </div>
                </div>

                <!-- SUPER ACCORDION CONTAINER -->
                <div id="documentationAccordion">
                    <!-- SuperAccordion será renderizado aqui -->
                </div> <!-- fim documentation-accordion -->
            </div>
        </section>
    </main>

    <!-- Modal: Sobre -->
    <div id="aboutModal" class="modal" role="dialog" aria-labelledby="about-modal-title" aria-hidden="true">
        <div class="modal-content" style="max-width: 900px; width: 90vw;">
            <div class="modal-header">
                <h2 id="about-modal-title" class="modal-title" data-i18n="modal.about.title">
                    Sobre o Cidadão.AI Backend
                </h2>
                <button class="modal-close" data-modal-close="aboutModal" aria-label="Fechar modal">
                    ×
                </button>
            </div>
            <div class="modal-body">
                <div class="about-intro mb-6">
                    <p><strong>Cidadão.AI</strong> é um projeto de pesquisa, software livre e engajamento cívico, idealizado e desenvolvido por Anderson Henrique da Silva, como Trabalho de Conclusão de Curso (TCC), sob a orientação da Profa. Dra. Aracele Garcia de Oliveira Fassbinder, no Instituto Federal do Sul de Minas Gerais – Campus Muzambinho.</p>
                    <p class="mt-4">Este sistema multi-agente foi concebido com o propósito de democratizar o acesso aos dados públicos brasileiros, unindo ética, tecnologia e cidadania.</p>
                </div>
                
                <div class="author-section mb-6">
                    <h3 class="mb-4">👨‍💻 Autor</h3>
                    <div class="author-profile" style="display: flex; gap: 2rem; align-items: center;">
                        <img src="assets/img/author.png" alt="Anderson Henrique da Silva" class="author-photo" loading="lazy" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover;">
                        <div class="author-info">
                            <p><strong>Anderson Henrique da Silva</strong></p>
                            <p class="text-secondary">Bacharelando em Ciência da Computação | Engenheiro de Sistemas de IA</p>
                            <div class="author-links mt-3">
                                <a href="https://github.com/anderson-ufrj" target="_blank" rel="noopener">🔗 GitHub</a>
                                <a href="https://huggingface.co/neural-thinker" target="_blank" rel="noopener">🔗 Hugging Face</a>
                                <a href="https://www.linkedin.com/in/anderson-henrique/" target="_blank" rel="noopener">🔗 LinkedIn</a>
                                <a href="mailto:andersonhs27@gmail.com">📧 andersonhs27@gmail.com</a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="supervision-section mb-6">
                    <h3 class="mb-4">🧠 Orientação Acadêmica</h3>
                    <p><strong>Profa. Dra. Aracele Garcia de Oliveira Fassbinder</strong></p>
                    <p class="text-secondary">📍 Instituto Federal do Sul de Minas Gerais – Campus Muzambinho</p>
                    <p class="mt-2"><a href="http://lattes.cnpq.br/" target="_blank" rel="noopener">🔗 Currículo Lattes</a></p>
                </div>
                
                <div class="tech-section mb-6">
                    <h3 class="mb-3">🧰 Tecnologias Utilizadas</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li><strong>Backend API:</strong> Python, FastAPI, LangChain, ChromaDB, FAISS, BERTimbau</li>
                        <li><strong>Banco de Dados:</strong> MongoDB</li>
                        <li><strong>Frontend:</strong> Next.js 15, React 18, TypeScript, Tailwind CSS, Zustand</li>
                        <li><strong>API Documentation:</strong> Swagger UI, ReDoc (automático)</li>
                        <li><strong>Deploy:</strong> Vercel (Frontend), Hugging Face Spaces (Backend API)</li>
                        <li><strong>Internacionalização:</strong> next-intl (Português/Inglês)</li>
                    </ul>
                </div>
                
                <div class="licenses-section mb-6">
                    <h3 class="mb-3">🔐 Licenças e Direitos</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li>• Código-fonte licenciado sob Apache License 2.0.</li>
                        <li>• Todos os modelos e bibliotecas de terceiros respeitam suas respectivas licenças.</li>
                        <li>• Os dados públicos utilizados seguem a Lei de Acesso à Informação (Lei nº 12.527/2011).</li>
                    </ul>
                </div>
                
                <div class="institutional-section mb-6">
                    <h3 class="mb-3">🏛️ Apoio Institucional</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li>• Instituto Federal de Educação, Ciência e Tecnologia do Sul de Minas Gerais</li>
                        <li>• Curso de Bacharelado em Ciência da Computação</li>
                        <li>• Projeto vinculado à Agenda 2030 – ODS 16: Paz, Justiça e Instituições Eficazes</li>
                        <li>• Alinhado às diretrizes da Parceria para Governo Aberto (Open Government Partnership – OGP)</li>
                    </ul>
                </div>
                
                <div class="research-section mb-6">
                    <h3 class="mb-3">📚 Notas de Pesquisa do Autor</h3>
                    <p><strong>Anderson Henrique da Silva - Notas de Pesquisa Completas</strong></p>
                    <p class="text-secondary">Documentação detalhada do processo de pesquisa, metodologia e descobertas durante o desenvolvimento do projeto.</p>
                    <p class="mt-3">
                        <a href="https://cidadao-ai-frontend.vercel.app/Notas-de-Pesquisa.pdf" target="_blank" rel="noopener" class="btn btn-primary">
                            📄 Visualizar PDF
                        </a>
                    </p>
                </div>
                
                <div class="official-links-section">
                    <h3 class="mb-3">🌐 Links Oficiais</h3>
                    <div class="link-card" style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 0.5rem; margin-top: 1rem;">
                        <h4>📚 Hub de Documentação Oficial</h4>
                        <p><a href="https://anderson-ufrj.github.io/cidadao.ai-docs/" target="_blank" rel="noopener">anderson-ufrj.github.io/cidadao.ai-docs/</a></p>
                        <p class="text-secondary mt-2">Documentação completa do projeto, guias de uso, arquitetura e API.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Arquitetura -->
    <div id="architectureModal" class="modal" role="dialog" aria-labelledby="architecture-modal-title" aria-hidden="true">
        <div class="modal-content" style="max-width: 1200px; width: 95vw;">
            <div class="modal-header">
                <h2 id="architecture-modal-title" class="modal-title" data-i18n="modal.architecture.title">
                    Arquitetura do Sistema
                </h2>
                <button class="modal-close" data-modal-close="architectureModal" aria-label="Fechar modal">
                    ×
                </button>
            </div>
            <div class="modal-body">
                <p class="mb-6" data-i18n="modal.architecture.content">
                    O Cidadão.AI Backend implementa uma arquitetura enterprise-grade com sistema multi-agente, API REST com 40+ endpoints, e infraestrutura containerizada para análise de transparência governamental brasileira.
                </p>
                
                <div class="architecture-overview mb-6">
                    <h3 class="mb-4">🏗️ Componentes Principais</h3>
                    <div class="tech-grid">
                        <div class="tech-item">
                            <strong>API Layer:</strong> FastAPI com 40+ endpoints documentados
                        </div>
                        <div class="tech-item">
                            <strong>Multi-Agent System:</strong> 15 agentes especializados
                        </div>
                        <div class="tech-item">
                            <strong>Data Layer:</strong> PostgreSQL + Redis + ChromaDB
                        </div>
                        <div class="tech-item">
                            <strong>Security:</strong> JWT + OAuth2 + Rate Limiting
                        </div>
                    </div>
                </div>

                <div class="agents-overview">
                    <h3 class="mb-4">🤖 Agentes Especializados</h3>
                    <ul class="agents-list">
                        <li>• <strong>Abaporu:</strong> Núcleo central da IA</li>
                        <li>• <strong>Zumbi:</strong> Investigador de padrões</li>
                        <li>• <strong>Anita Garibaldi:</strong> Roteadora semântica</li>
                        <li>• <strong>Tiradentes:</strong> Avaliador de riscos</li>
                        <li>• <strong>Nanã:</strong> Agente temporal</li>
                        <li>• <strong>José Bonifácio:</strong> Políticas públicas</li>
                        <li>• <strong>Dandara:</strong> Justiça social</li>
                        <li>• <strong>Machado de Assis:</strong> Análise textual</li>
                        <li>• <strong>Obaluaiê:</strong> Detector de corrupção</li>
                        <li>• <strong>Niemeyer:</strong> Visualização gráfica</li>
                        <li>• <strong>Lampião:</strong> Executor técnico ETL</li>
                        <li>• <strong>Ceuci:</strong> Agente preditivo</li>
                        <li>• <strong>Carlos Drummond:</strong> Comunicador do povo</li>
                        <li>• <strong>Maria Quitéria:</strong> Guardiã da integridade</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Modo de Leitura -->
    <div id="readingModal" class="modal reading-modal" role="dialog" aria-labelledby="reading-modal-title" aria-hidden="true">
        <div class="reading-modal-content">
            <!-- Barra de Progresso do Modo Leitura -->
            <div class="reading-progress-bar" id="readingProgressBar">
                <div class="reading-progress-fill" id="readingProgress"></div>
            </div>
            
            <!-- Conteúdo do Modal de Leitura -->
            <div class="reading-modal-body" id="readingModalBody">
                <div class="reading-content" id="readingContent">
                    <!-- Conteúdo será inserido dinamicamente aqui -->
                </div>
            </div>
            
            <!-- Navegação Lateral -->
            <nav class="reading-sidebar" id="readingSidebar">
                <h3 class="reading-sidebar-title" data-i18n="reading.index">📑 Índice</h3>
                <div class="reading-nav-list" id="readingNavList">
                    <!-- Links de navegação serão inseridos aqui -->
                </div>
            </nav>
            
            <!-- Botão Voltar ao Topo -->
            <button class="reading-back-to-top" id="backToTopBtn" data-i18n="reading.back-to-top" aria-label="Voltar ao topo">
                ↑
            </button>
        </div>
    </div>

    <!-- Botão Flutuante de Informações -->
    <button class="floating-button" data-modal-open="aboutModal" aria-label="Informações sobre o projeto" title="Sobre o Cidadão.AI Backend">
        ℹ️
    </button>

    <!-- Scripts -->
    <script src="assets/js/main.js"></script>
    <!-- Lazy Loader removed for cleaner production build -->
    <script>
        // Accordion Debug Helper
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Cidadão.AI Documentation ready!');
            
            // Debug: Check accordion state after initialization
            setTimeout(() => {
                const categories = document.querySelectorAll('.accordion-category');
                const items = document.querySelectorAll('.accordion-item');
                
                console.log(`📊 Accordion Debug Info:`);
                console.log(`- Categories found: ${categories.length}`);
                console.log(`- Items found: ${items.length}`);
                
                // Check if toggles have click handlers
                const categoryToggles = document.querySelectorAll('.category-toggle');
                const itemToggles = document.querySelectorAll('.item-toggle');
                
                console.log(`- Category toggles: ${categoryToggles.length}`);
                console.log(`- Item toggles: ${itemToggles.length}`);
                
                // Force initial state
                categories.forEach(cat => {
                    const toggle = cat.querySelector('.category-toggle');
                    const content = cat.querySelector('.category-content');
                    if (toggle && content) {
                        // Ensure initial collapsed state
                        toggle.setAttribute('aria-expanded', 'false');
                        content.classList.remove('expanded');
                    }
                });
                
                items.forEach(item => {
                    const toggle = item.querySelector('.item-toggle');
                    const content = item.querySelector('.item-content');
                    if (toggle && content) {
                        // Ensure initial collapsed state
                        toggle.setAttribute('aria-expanded', 'false');
                        content.classList.remove('expanded');
                    }
                });
                
                console.log('✅ Accordion initial state set');
            }, 500);
        });
    </script>
    
    <!-- Sistema simplificado - OfflineAccordion only -->
    

    <!-- SUPER ACCORDION SYSTEM -->
    <script>
        // Inicialização do SuperAccordion
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Inicializando SuperAccordion...');
            
            try {
                // Criar instância do OfflineAccordion
                window.offlineAccordion = new OfflineAccordion({
                    containerSelector: '#documentationAccordion',
                    contentPath: 'content/',
                    searchMinLength: 2,
                    debounceDelay: 300,
                    lazyLoadOffset: 100,
                    cacheExpiry: 5 * 60 * 1000, // 5 minutos
                    animationDuration: 300,
                    readingModeWidth: '800px'
                });
                
                // Inicializar sistema
                await window.offlineAccordion.init();
                
                console.log('✅ OfflineAccordion inicializado com sucesso!');
                
                // Os controles são gerenciados internamente pelo OfflineAccordion
                
                // Expor métodos para debug (apenas em desenvolvimento)
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    window.debugAccordion = () => window.offlineAccordion.getDebugInfo();
                    console.log('🔧 Debug: use window.debugAccordion() para informações');
                }
                
            } catch (error) {
                console.error('❌ Erro ao inicializar OfflineAccordion:', error);
                
                // Fallback básico
                const container = document.querySelector('#documentationAccordion');
                if (container) {
                    container.innerHTML = `
                        <div style="padding: 2rem; text-align: center; color: #dc2626; background: #fee; border: 1px solid #f56565; border-radius: 8px; margin: 1rem;">
                            <h3>❌ Erro no Sistema de Documentação</h3>
                            <p><strong>Erro:</strong> ${error.message}</p>
                            <p>Verifique o console para mais detalhes.</p>
                            <button onclick="location.reload()" style="background: #dc2626; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.25rem; cursor: pointer;">
                                🔄 Recarregar Página
                            </button>
                        </div>
                    `;
                }
            }
        });
        
        // Event listeners para integração com controles do header
        document.addEventListener('DOMContentLoaded', function() {
            // Sincronizar com mudanças de tema
            const themeBtns = document.querySelectorAll('[data-theme-btn]');
            themeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // O OfflineAccordion detecta automaticamente mudanças via MutationObserver
                    console.log('🎨 Tema alterado - OfflineAccordion sincronizará automaticamente');
                });
            });
            
            // Sincronizar com mudanças de idioma
            const langBtns = document.querySelectorAll('[data-lang-btn]');
            langBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // O OfflineAccordion detecta automaticamente mudanças via MutationObserver
                    console.log('🌐 Idioma alterado - OfflineAccordion sincronizará automaticamente');
                });
            });
        });
    </script>

</body>
</html>