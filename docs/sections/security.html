<div class="section-header">
    <h2 class="section-title">
        üîí <span data-pt="Framework de Seguran√ßa" data-en="Security Framework">Framework de Seguran√ßa</span>
    </h2>
    <p class="section-description" data-pt="Abordagem abrangente de seguran√ßa para o sistema Cidad√£o.AI, incluindo autentica√ß√£o, autoriza√ß√£o, criptografia e conformidade com LGPD." data-en="Comprehensive security approach for the Cidad√£o.AI system, including authentication, authorization, encryption, and LGPD compliance.">
        Abordagem abrangente de seguran√ßa para o sistema Cidad√£o.AI, incluindo autentica√ß√£o, autoriza√ß√£o, criptografia e conformidade com LGPD.
    </p>
</div>

<style>
    .security-section {
        margin-bottom: 3rem;
        padding: 2rem;
        background-color: var(--bg-secondary);
        border-radius: 0.5rem;
        border: 1px solid var(--border);
    }
    
    .security-section h3 {
        color: var(--text-primary);
        margin-bottom: 1.5rem;
        font-size: 1.5rem;
        font-weight: 600;
        border-bottom: 2px solid var(--border-light);
        padding-bottom: 0.5rem;
    }
    
    .security-layer {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin: 1rem 0;
    }
    
    .security-layer h4 {
        color: var(--text-accent);
        margin-bottom: 1rem;
        font-size: 1.125rem;
        font-weight: 600;
    }
    
    .threat-model {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
    }
    
    .threat-item {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1.5rem;
        border-left: 4px solid var(--color-error);
    }
    
    .threat-item h4 {
        color: var(--color-error);
        margin-bottom: 0.5rem;
        font-weight: 600;
    }
    
    .mitigation {
        background-color: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 0.25rem;
        padding: 1rem;
        margin: 0.5rem 0;
        border-left: 4px solid var(--color-success);
    }
    
    .mitigation h5 {
        color: var(--color-success);
        margin-bottom: 0.5rem;
        font-weight: 600;
    }
    
    .compliance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
    }
    
    .compliance-item {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1.5rem;
        text-align: center;
    }
    
    .compliance-status {
        display: inline-block;
        padding: 0.5rem 1rem;
        border-radius: 1rem;
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: 1rem;
    }
    
    .status-compliant {
        background-color: var(--color-success);
        color: white;
    }
    
    .status-partial {
        background-color: var(--color-warning);
        color: white;
    }
    
    .status-pending {
        background-color: var(--color-neutral);
        color: white;
    }
    
    .encryption-flow {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
    }
    
    .encryption-step {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1rem;
        text-align: center;
        position: relative;
    }
    
    .encryption-step::after {
        content: 'üîí';
        position: absolute;
        right: -0.5rem;
        top: 50%;
        transform: translateY(-50%);
        background-color: var(--bg-accent);
        color: white;
        padding: 0.25rem;
        border-radius: 50%;
        font-size: 0.875rem;
    }
    
    .encryption-step:last-child::after {
        display: none;
    }
    
    .auth-mechanism {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1.5rem;
        margin: 1rem 0;
    }
    
    .auth-flow {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin: 1rem 0;
    }
    
    .auth-step {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background-color: var(--bg-secondary);
        border-radius: 0.25rem;
    }
    
    .auth-step-number {
        background-color: var(--bg-accent);
        color: white;
        border-radius: 50%;
        width: 2rem;
        height: 2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        flex-shrink: 0;
    }
    
    .security-metric {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        margin: 0.5rem 0;
    }
    
    .metric-name {
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .metric-value {
        font-weight: 700;
        color: var(--brazil-blue);
    }
    
    .code-security {
        background-color: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1rem;
        margin: 1rem 0;
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.875rem;
        overflow-x: auto;
    }
    
    .security-alert {
        background-color: #fef2f2;
        border: 1px solid #fecaca;
        border-radius: 0.375rem;
        padding: 1rem;
        margin: 1rem 0;
        border-left: 4px solid var(--color-error);
    }
    
    [data-theme="dark"] .security-alert {
        background-color: #1f1917;
        border-color: #451a03;
    }
    
    .security-alert h4 {
        color: var(--color-error);
        margin-bottom: 0.5rem;
    }
    
    .vulnerability-scan {
        background-color: var(--bg-primary);
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        padding: 1.5rem;
        margin: 1rem 0;
    }
    
    .scan-result {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem;
        background-color: var(--bg-secondary);
        border-radius: 0.25rem;
        margin: 0.5rem 0;
    }
    
    .severity-critical { border-left: 4px solid #dc2626; }
    .severity-high { border-left: 4px solid #ea580c; }
    .severity-medium { border-left: 4px solid #d97706; }
    .severity-low { border-left: 4px solid #65a30d; }
    .severity-info { border-left: 4px solid #0ea5e9; }
</style>

<!-- Security Overview -->
<div class="security-section">
    <h3>üõ°Ô∏è <span data-pt="Vis√£o Geral da Seguran√ßa" data-en="Security Overview">Vis√£o Geral da Seguran√ßa</span></h3>
    
    <div class="security-alert">
        <h4>‚ö†Ô∏è <span data-pt="Premissa de Seguran√ßa" data-en="Security Premise">Premissa de Seguran√ßa</span></h4>
        <p data-pt="O sistema Cidad√£o.AI processa exclusivamente dados p√∫blicos oficiais, n√£o coletando, armazenando ou processando informa√ß√µes pessoais ou sens√≠veis." data-en="The Cidad√£o.AI system processes exclusively official public data, not collecting, storing, or processing personal or sensitive information.">
            O sistema Cidad√£o.AI processa exclusivamente dados p√∫blicos oficiais, n√£o coletando, armazenando ou processando informa√ß√µes pessoais ou sens√≠veis.
        </p>
    </div>
    
    <div class="security-layer">
        <h4>üéØ <span data-pt="Princ√≠pios de Seguran√ßa" data-en="Security Principles">Princ√≠pios de Seguran√ßa</span></h4>
        <ul>
            <li data-pt="**Defense in Depth**: M√∫ltiplas camadas de prote√ß√£o" data-en="**Defense in Depth**: Multiple layers of protection">
                <strong>Defense in Depth</strong>: M√∫ltiplas camadas de prote√ß√£o
            </li>
            <li data-pt="**Least Privilege**: Acesso m√≠nimo necess√°rio" data-en="**Least Privilege**: Minimum necessary access">
                <strong>Least Privilege</strong>: Acesso m√≠nimo necess√°rio
            </li>
            <li data-pt="**Zero Trust**: Verifica√ß√£o cont√≠nua de identidade" data-en="**Zero Trust**: Continuous identity verification">
                <strong>Zero Trust</strong>: Verifica√ß√£o cont√≠nua de identidade
            </li>
            <li data-pt="**Privacy by Design**: Privacidade desde a concep√ß√£o" data-en="**Privacy by Design**: Privacy from conception">
                <strong>Privacy by Design</strong>: Privacidade desde a concep√ß√£o
            </li>
        </ul>
    </div>
</div>

<!-- Authentication & Authorization -->
<div class="security-section">
    <h3>üîê <span data-pt="Autentica√ß√£o e Autoriza√ß√£o" data-en="Authentication & Authorization">Autentica√ß√£o e Autoriza√ß√£o</span></h3>
    
    <div class="auth-mechanism">
        <h4>üîë <span data-pt="Mecanismo de Autentica√ß√£o" data-en="Authentication Mechanism">Mecanismo de Autentica√ß√£o</span></h4>
        
        <div class="auth-flow">
            <div class="auth-step">
                <div class="auth-step-number">1</div>
                <div>
                    <strong data-pt="Requisi√ß√£o de Token" data-en="Token Request">Requisi√ß√£o de Token</strong>
                    <p data-pt="Cliente envia credenciais via HTTPS" data-en="Client sends credentials via HTTPS">Cliente envia credenciais via HTTPS</p>
                </div>
            </div>
            
            <div class="auth-step">
                <div class="auth-step-number">2</div>
                <div>
                    <strong data-pt="Valida√ß√£o Multi-Fator" data-en="Multi-Factor Validation">Valida√ß√£o Multi-Fator</strong>
                    <p data-pt="Verifica√ß√£o de credenciais + 2FA" data-en="Credential verification + 2FA">Verifica√ß√£o de credenciais + 2FA</p>
                </div>
            </div>
            
            <div class="auth-step">
                <div class="auth-step-number">3</div>
                <div>
                    <strong data-pt="Gera√ß√£o de JWT" data-en="JWT Generation">Gera√ß√£o de JWT</strong>
                    <p data-pt="Token assinado com RS256" data-en="Token signed with RS256">Token assinado com RS256</p>
                </div>
            </div>
            
            <div class="auth-step">
                <div class="auth-step-number">4</div>
                <div>
                    <strong data-pt="Valida√ß√£o de Acesso" data-en="Access Validation">Valida√ß√£o de Acesso</strong>
                    <p data-pt="Verifica√ß√£o de permiss√µes RBAC" data-en="RBAC permission verification">Verifica√ß√£o de permiss√µes RBAC</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="code-security">
# JWT Token Configuration
JWT_SETTINGS = {
    "algorithm": "RS256",
    "access_token_expire_minutes": 30,
    "refresh_token_expire_days": 7,
    "issuer": "cidadao.ai",
    "audience": "api.cidadao.ai"
}

# RBAC Implementation
class RoleBasedAccessControl:
    ROLES = {
        "admin": ["read", "write", "delete", "manage_users"],
        "investigator": ["read", "write", "create_investigations"],
        "analyst": ["read", "analyze", "generate_reports"],
        "viewer": ["read"]
    }
    
    def has_permission(self, user_role: str, required_permission: str) -> bool:
        return required_permission in self.ROLES.get(user_role, [])
    </div>
</div>

<!-- Data Encryption -->
<div class="security-section">
    <h3>üîí <span data-pt="Criptografia de Dados" data-en="Data Encryption">Criptografia de Dados</span></h3>
    
    <div class="encryption-flow">
        <div class="encryption-step">
            <h4>üåê <span data-pt="Em Tr√¢nsito" data-en="In Transit">Em Tr√¢nsito</span></h4>
            <p>TLS 1.3</p>
            <p>HSTS Enabled</p>
        </div>
        
        <div class="encryption-step">
            <h4>üóÑÔ∏è <span data-pt="Em Repouso" data-en="At Rest">Em Repouso</span></h4>
            <p>AES-256-GCM</p>
            <p>Key Rotation</p>
        </div>
        
        <div class="encryption-step">
            <h4>üîÑ <span data-pt="Em Processamento" data-en="In Processing">Em Processamento</span></h4>
            <p>Memory Encryption</p>
            <p>Secure Enclaves</p>
        </div>
        
        <div class="encryption-step">
            <h4>üóùÔ∏è <span data-pt="Gerenciamento" data-en="Management">Gerenciamento</span></h4>
            <p>HSM Integration</p>
            <p>Key Escrow</p>
        </div>
    </div>
    
    <div class="code-security">
# Encryption Implementation
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
import os

class DataEncryption:
    def __init__(self):
        self.key = os.environ.get("ENCRYPTION_KEY").encode()
        
    def encrypt_data(self, data: str) -> bytes:
        iv = os.urandom(12)  # GCM requires 12 bytes IV
        cipher = Cipher(
            algorithms.AES(self.key),
            modes.GCM(iv),
            backend=default_backend()
        )
        encryptor = cipher.encryptor()
        ciphertext = encryptor.update(data.encode()) + encryptor.finalize()
        return iv + encryptor.tag + ciphertext
    
    def decrypt_data(self, encrypted_data: bytes) -> str:
        iv = encrypted_data[:12]
        tag = encrypted_data[12:28]
        ciphertext = encrypted_data[28:]
        
        cipher = Cipher(
            algorithms.AES(self.key),
            modes.GCM(iv, tag),
            backend=default_backend()
        )
        decryptor = cipher.decryptor()
        return (decryptor.update(ciphertext) + decryptor.finalize()).decode()
    </div>
</div>

<!-- Threat Model -->
<div class="security-section">
    <h3>‚ö†Ô∏è <span data-pt="Modelo de Amea√ßas" data-en="Threat Model">Modelo de Amea√ßas</span></h3>
    
    <div class="threat-model">
        <div class="threat-item">
            <h4>üîì <span data-pt="Acesso N√£o Autorizado" data-en="Unauthorized Access">Acesso N√£o Autorizado</span></h4>
            <p data-pt="Tentativas de acesso por usu√°rios n√£o autenticados" data-en="Access attempts by unauthenticated users">Tentativas de acesso por usu√°rios n√£o autenticados</p>
            <div class="mitigation">
                <h5>üõ°Ô∏è <span data-pt="Mitiga√ß√£o" data-en="Mitigation">Mitiga√ß√£o</span></h5>
                <p data-pt="Autentica√ß√£o multi-fator obrigat√≥ria" data-en="Mandatory multi-factor authentication">Autentica√ß√£o multi-fator obrigat√≥ria</p>
            </div>
        </div>
        
        <div class="threat-item">
            <h4>üö® <span data-pt="Inje√ß√£o de Dados" data-en="Data Injection">Inje√ß√£o de Dados</span></h4>
            <p data-pt="Tentativas de inje√ß√£o SQL, NoSQL ou c√≥digo" data-en="SQL, NoSQL, or code injection attempts">Tentativas de inje√ß√£o SQL, NoSQL ou c√≥digo</p>
            <div class="mitigation">
                <h5>üõ°Ô∏è <span data-pt="Mitiga√ß√£o" data-en="Mitigation">Mitiga√ß√£o</span></h5>
                <p data-pt="Valida√ß√£o rigorosa com Pydantic + ORM" data-en="Strict validation with Pydantic + ORM">Valida√ß√£o rigorosa com Pydantic + ORM</p>
            </div>
        </div>
        
        <div class="threat-item">
            <h4>üîÑ <span data-pt="Ataques DDoS" data-en="DDoS Attacks">Ataques DDoS</span></h4>
            <p data-pt="Sobrecarga do sistema com requisi√ß√µes maliciosas" data-en="System overload with malicious requests">Sobrecarga do sistema com requisi√ß√µes maliciosas</p>
            <div class="mitigation">
                <h5>üõ°Ô∏è <span data-pt="Mitiga√ß√£o" data-en="Mitigation">Mitiga√ß√£o</span></h5>
                <p data-pt="Rate limiting + WAF + CDN" data-en="Rate limiting + WAF + CDN">Rate limiting + WAF + CDN</p>
            </div>
        </div>
        
        <div class="threat-item">
            <h4>üé≠ <span data-pt="Manipula√ß√£o de IA" data-en="AI Manipulation">Manipula√ß√£o de IA</span></h4>
            <p data-pt="Tentativas de envenenar ou manipular modelos" data-en="Attempts to poison or manipulate models">Tentativas de envenenar ou manipular modelos</p>
            <div class="mitigation">
                <h5>üõ°Ô∏è <span data-pt="Mitiga√ß√£o" data-en="Mitigation">Mitiga√ß√£o</span></h5>
                <p data-pt="Valida√ß√£o de entrada + modelo isolado" data-en="Input validation + isolated model">Valida√ß√£o de entrada + modelo isolado</p>
            </div>
        </div>
    </div>
</div>

<!-- Compliance -->
<div class="security-section">
    <h3>‚öñÔ∏è <span data-pt="Conformidade Legal" data-en="Legal Compliance">Conformidade Legal</span></h3>
    
    <div class="compliance-grid">
        <div class="compliance-item">
            <div class="compliance-status status-compliant">‚úÖ <span data-pt="CONFORME" data-en="COMPLIANT">CONFORME</span></div>
            <h4>LGPD</h4>
            <p data-pt="Lei Geral de Prote√ß√£o de Dados" data-en="General Data Protection Law">Lei Geral de Prote√ß√£o de Dados</p>
        </div>
        
        <div class="compliance-item">
            <div class="compliance-status status-compliant">‚úÖ <span data-pt="CONFORME" data-en="COMPLIANT">CONFORME</span></div>
            <h4>LAI</h4>
            <p data-pt="Lei de Acesso √† Informa√ß√£o" data-en="Freedom of Information Act">Lei de Acesso √† Informa√ß√£o</p>
        </div>
        
        <div class="compliance-item">
            <div class="compliance-status status-partial">‚ö†Ô∏è <span data-pt="PARCIAL" data-en="PARTIAL">PARCIAL</span></div>
            <h4>ISO 27001</h4>
            <p data-pt="Gest√£o de Seguran√ßa da Informa√ß√£o" data-en="Information Security Management">Gest√£o de Seguran√ßa da Informa√ß√£o</p>
        </div>
        
        <div class="compliance-item">
            <div class="compliance-status status-pending">üîÑ <span data-pt="PENDENTE" data-en="PENDING">PENDENTE</span></div>
            <h4>SOC 2</h4>
            <p data-pt="Service Organization Control 2" data-en="Service Organization Control 2">Service Organization Control 2</p>
        </div>
    </div>
</div>

<!-- Security Monitoring -->
<div class="security-section">
    <h3>üìä <span data-pt="Monitoramento de Seguran√ßa" data-en="Security Monitoring">Monitoramento de Seguran√ßa</span></h3>
    
    <div class="security-metric">
        <span class="metric-name" data-pt="Tentativas de Login Falhadas" data-en="Failed Login Attempts">Tentativas de Login Falhadas</span>
        <span class="metric-value">< 0.1%</span>
    </div>
    
    <div class="security-metric">
        <span class="metric-name" data-pt="Tempo de Detec√ß√£o de Amea√ßas" data-en="Threat Detection Time">Tempo de Detec√ß√£o de Amea√ßas</span>
        <span class="metric-value">< 30s</span>
    </div>
    
    <div class="security-metric">
        <span class="metric-name" data-pt="Patching SLA" data-en="Patching SLA">Patching SLA</span>
        <span class="metric-value">< 48h</span>
    </div>
    
    <div class="security-metric">
        <span class="metric-name" data-pt="Vulnerabilidades Cr√≠ticas" data-en="Critical Vulnerabilities">Vulnerabilidades Cr√≠ticas</span>
        <span class="metric-value">0</span>
    </div>
</div>

<!-- Vulnerability Assessment -->
<div class="security-section">
    <h3>üîç <span data-pt="Avalia√ß√£o de Vulnerabilidades" data-en="Vulnerability Assessment">Avalia√ß√£o de Vulnerabilidades</span></h3>
    
    <div class="vulnerability-scan">
        <h4>üìä <span data-pt="√öltimo Scan de Seguran√ßa" data-en="Latest Security Scan">√öltimo Scan de Seguran√ßa</span></h4>
        <p data-pt="Executado em: 2024-01-15 | Pr√≥ximo: 2024-01-22" data-en="Executed on: 2024-01-15 | Next: 2024-01-22">Executado em: 2024-01-15 | Pr√≥ximo: 2024-01-22</p>
        
        <div class="scan-result severity-info">
            <span data-pt="Depend√™ncias Atualizadas" data-en="Updated Dependencies">Depend√™ncias Atualizadas</span>
            <span>456 ‚úÖ</span>
        </div>
        
        <div class="scan-result severity-low">
            <span data-pt="Vulnerabilidades Baixas" data-en="Low Vulnerabilities">Vulnerabilidades Baixas</span>
            <span>2 ‚ö†Ô∏è</span>
        </div>
        
        <div class="scan-result severity-medium">
            <span data-pt="Vulnerabilidades M√©dias" data-en="Medium Vulnerabilities">Vulnerabilidades M√©dias</span>
            <span>0 ‚úÖ</span>
        </div>
        
        <div class="scan-result severity-high">
            <span data-pt="Vulnerabilidades Altas" data-en="High Vulnerabilities">Vulnerabilidades Altas</span>
            <span>0 ‚úÖ</span>
        </div>
        
        <div class="scan-result severity-critical">
            <span data-pt="Vulnerabilidades Cr√≠ticas" data-en="Critical Vulnerabilities">Vulnerabilidades Cr√≠ticas</span>
            <span>0 ‚úÖ</span>
        </div>
    </div>
</div>

<!-- Security Automation -->
<div class="security-section">
    <h3>ü§ñ <span data-pt="Automa√ß√£o de Seguran√ßa" data-en="Security Automation">Automa√ß√£o de Seguran√ßa</span></h3>
    
    <div class="code-security">
# Security Automation Pipeline
name: Security Scan
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM

jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Run Bandit Security Scan
        run: |
          pip install bandit
          bandit -r src/ -f json -o bandit-report.json
          
      - name: Run Safety Check
        run: |
          pip install safety
          safety check --json --output safety-report.json
          
      - name: Run Semgrep
        run: |
          pip install semgrep
          semgrep --config=auto --json --output=semgrep-report.json
          
      - name: Upload Security Reports
        uses: actions/upload-artifact@v2
        with:
          name: security-reports
          path: |
            bandit-report.json
            safety-report.json
            semgrep-report.json
    </div>
</div>

<!-- Next Section Preview -->
<div class="info-card">
    <h4>üîÆ <span data-pt="Pr√≥xima Se√ß√£o: An√°lise de Performance" data-en="Next Section: Performance Analysis">Pr√≥xima Se√ß√£o: An√°lise de Performance</span></h4>
    <p data-pt="A pr√≥xima se√ß√£o apresentar√° m√©tricas detalhadas de performance, benchmarks e otimiza√ß√µes implementadas no sistema." data-en="The next section will present detailed performance metrics, benchmarks, and optimizations implemented in the system.">
        A pr√≥xima se√ß√£o apresentar√° m√©tricas detalhadas de performance, benchmarks e otimiza√ß√µes implementadas no sistema.
    </p>
</div>